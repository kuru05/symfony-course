{# templates/article/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Tous les articles
{% endblock %}

{% block body %}
	<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
		<h1>Le Fil d'Actualit√©</h1>

		{# Lien discret pour l'admin #}
		<a href="{{ path('app_article_new') }}" style="color: var(--text); font-size: 0.9rem; opacity: 0.7;">+ R√©diger un article</a>
	</div>

	{# Barre de recherche contextuelle #}
	<form method="get" style="margin-bottom: 30px; display: flex; gap: 10px;">
		<input type="text" name="q" placeholder="Rechercher un sujet, un titre..." value="{{ app.request.query.get('q') }}" style="padding: 10px; border: 1px solid #ddd; border-radius: 50px; flex: 1; padding-left: 20px;">
		<button type="submit" class="btn btn-primary">Rechercher</button>
	</form>

	<div class="article-grid">
		{% for article in articles %}
			<article class="article-card">
				<div class="card-img-placeholder">
					<span>üì∞</span>
				</div>

				<div class="card-content">
					<div
						class="card-category">
						{# On affiche le nom de la cat√©gorie (ex: Tech, Sport) #}
						{{ article.category ? article.category.name : 'G√©n√©ral' }}
					</div>

					<h2 class="card-title">{{ article.title }}</h2>

					{# Extrait de l'article #}
					<p class="card-excerpt">
						{{ article.content|slice(0, 120) ~ '...' }}
					</p>

					{# C'est ICI qu'on change l'action : On pointe vers la lecture #}
					<a href="{{ path('app_article_show', {'id': article.id}) }}" class="btn btn-primary" style="text-align: center;">Lire l'article</a>
				</div>

				<div class="card-footer">
					<span>Publi√© le
						{{ article.createdAt|date('d/m/Y') }}</span>
					<a href="{{ path('app_article_edit', {'id': article.id}) }}" style="color: #999; font-size: 0.8rem;">√âditer</a>
				</div>
			</article>
		{% else %}
			<div style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
				<p>Aucun article ne correspond √† votre recherche.</p>
			</div>
		{% endfor %}
	</div>

	<div
		style="margin-top: 2rem; display: flex; justify-content: center;">{# {{ knp_pagination_render(articles) }} #}
	</div>
{% endblock %}
